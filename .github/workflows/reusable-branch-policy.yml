---
name: "âœ… Reusable - Branch & PR Policy"

on:
  workflow_call:

jobs:
  pr-title:
    name: "ğŸ“ Validate PR Title"
    runs-on: ubuntu-latest
    steps:
      - name: "ğŸš€ Run semantic PR title check"
        uses: amannn/action-semantic-pull-request@v5
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  branch-name:
    name: "ğŸŒ¿ Validate Branch Name"
    runs-on: ubuntu-latest
    steps:
      - name: "ğŸ” Check branch name format"
        run: |
          BRANCH="${{ github.head_ref }}"
          regex='^(feature|bugfix|chore|hotfix)/([A-Z]+-[0-9]+-.+|[a-z0-9._-]+)$'
          if [[ ! "$BRANCH" =~ $regex ]]; then
            echo "âŒ Invalid branch name: $BRANCH"
            echo "Expected format:"
            echo "  feature/ABC-123-description"
            echo "  or feature/shortname"
            exit 1
          fi
          echo "âœ… Branch name valid: $BRANCH"
